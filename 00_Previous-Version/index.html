<!DOCTYPE html>
<html>

  <head>

    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <!--<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCy57ndHPnW1X3zYFFnBkdvJoJ-OW8Krsc&sensor=true"></script>-->
    <script type="text/javascript" src="js/jquery-1.7.2.js"></script>
    <script type="text/javascript" src="js/underscore-1.3.3.js"></script>
    <script type="text/javascript" src="js/backbone-0.9.2.js"></script>
    <script type="text/javascript">
    

/*function CreateDescriptionWindow(options) {
  this.latlng_  = options.latlng;
  this.map_     = options.map;
  this.div_     = null;

  this.setMap(options.map);
}

CreateDescriptionWindow.prototype = new google.maps.OverlayView();

CreateDescriptionWindow.prototype.onAdd = function() {
  var div = document.createElement('div');
  div.style.position = 'relative';

  //----- CANVAS -----//
  var canvas = document.createElement('canvas');
  canvas.setAttribute('width', '331px');
  canvas.setAttribute('height', '96px');
  var context = canvas.getContext('2d');
  context.moveTo(10.5,0.5);
  context.lineTo(319.5,0.5);
  context.arc(319.5,10.5,10,1.5*Math.PI,2*Math.PI);
  context.lineTo(329.5,79.5);
  context.arc(319.5,79.5,10,0*Math.PI,0.5*Math.PI);
  context.lineTo(172.5,89.5);
  context.lineTo(165.5,95.5);
  context.lineTo(158.5,89.5);
  context.lineTo(10.5,89.5);
  context.arc(10.5,79.5,10,0.5*Math.PI,1*Math.PI);
  context.lineTo(0.5,10.5);
  context.arc(10.5,10.5,10,1*Math.PI,1.5*Math.PI);
  context.strokeStyle = '#212121';
  context.stroke();
  var gradient = context.createLinearGradient(0,0,0,45);
  gradient.addColorStop(0,'#363636');
  gradient.addColorStop(1,'#212121');
  context.fillStyle = gradient;
  context.fill();

  //----- CONTENT -----//
  var music = document.createElement('div');
  music.innerHTML = 'Little Dragon Mixtape <span style="color: #999997;">by <b>chloe.laisne</b></span>';
  music.style.color = '#ffffff';
  music.style.fontSize = '14px';
  music.style.height = '14px';
  music.style.paddingLeft = '20px';
  music.style.background = 'transparent url(../img/output-icons.png) no-repeat 0 -48px';
  music.style.position = 'absolute';
  music.style.top = '23px';
  music.style.left = '19px';
  music.style.lineHeight = '12px';
  var location = document.createElement('div');
  location.innerHTML = 'Hyper Island, Stockholm, Sweden';
  location.style.fontSize = '11px';
  location.style.color = '#999997';
  location.style.height = '18px';
  location.style.paddingLeft = '20px';
  location.style.background = 'transparent url(../img/output-icons.png) no-repeat 0 -76px';
  location.style.position = 'absolute';
  location.style.top = '47px';
  location.style.left = '19px';
  location.style.lineHeight = '16px';
  
  
  div.appendChild(music);
  div.appendChild(location);
  div.appendChild(canvas);
  this.div_ = div;

  var panes = this.getPanes();
  panes.overlayLayer.appendChild(div);
}

CreateDescriptionWindow.prototype.draw = function() {
  var position = this.getProjection().fromLatLngToDivPixel(this.latlng_);
  this.div_.style.left = (position.x + -165) + "px";
  this.div_.style.top = (position.y + -135) + "px";
}

CreateDescriptionWindow.prototype.onRemove = function() {
  this.div_.parentNode.removeChild(this.div_);
  this.div_ = null;
}

function CreateLocationWindow(options) {
  this.latlng_  = options.latlng;
  this.map_     = options.map;
  this.div_     = null;

  this.setMap(options.map);
}

CreateLocationWindow.prototype = new google.maps.OverlayView();

CreateLocationWindow.prototype.onAdd = function() {
  var div = document.createElement('div');
  div.style.position = 'relative';

  //----- CANVAS -----//
  var canvas = document.createElement('canvas');
  var context = canvas.getContext('2d');
  context.moveTo(11,0);
  context.lineTo(159,0);
  context.arc(159,5,5,1.5*Math.PI,2*Math.PI);
  context.lineTo(164,40);
  context.arc(159,40,5,0*Math.PI,0.5*Math.PI);
  context.lineTo(11,45);
  context.arc(11,40,5,0.5*Math.PI,1*Math.PI);
  context.lineTo(6,30);
  context.lineTo(0,23);
  context.lineTo(6,15);
  context.lineTo(6,5);
  context.arc(11,5,5,1*Math.PI,1.5*Math.PI);
  context.strokeStyle = '#212121';
  context.stroke();
  var gradient = context.createLinearGradient(0,0,0,45);
  gradient.addColorStop(0,'#363636');
  gradient.addColorStop(1,'#212121');
  context.fillStyle = gradient;
  context.fill();

  //----- BUTTONS -----//
  var buttons = document.createElement('div');
  buttons.style.position = 'absolute';
  buttons.style.top = 0;
  buttons.style.left = 0;
  buttons.style.width = '138px';
  buttons.style.height = '25px';
  buttons.style.marginLeft = '6px';
  buttons.style.padding = '10px';
  var button1 = document.createElement('button');
  button1.className = 'sp-button';
  button1.style.marginRight = '10px';
  button1.innerHTML = 'Confirm';
  var button2 = document.createElement('button');
  button2.className = 'sp-button';
  button2.innerHTML = 'Cancel';
    
  buttons.appendChild(button1);
  buttons.appendChild(button2);
  div.appendChild(buttons);
  div.appendChild(canvas);
  this.div_ = div;

  var panes = this.getPanes();
  panes.overlayLayer.appendChild(div);
}

CreateLocationWindow.prototype.draw = function() {
  var position = this.getProjection().fromLatLngToDivPixel(this.latlng_);
  this.div_.style.left = (position.x + 17) + "px";
  this.div_.style.top = (position.y + -47) + "px";
}

CreateLocationWindow.prototype.onRemove = function() {
  this.div_.parentNode.removeChild(this.div_);
  this.div_ = null;
}

// Run when the page is fully loaded including graphics.
$(window).load(function() {

  //----- FUNCTIONS -----//
  function stringShortener(element,maxwidth) {
    var stringwidth = element.width();
    var string = element.text();
    if(stringwidth == maxwidth && element.css("height") > element.css("line-height")) {
      var pattern = "...";
      var shortenedelement = element;
      var shortenedstring = shortenedelement.prepend(pattern).text();
      while(shortenedelement.css("height") > shortenedelement.css("line-height")) {
        shortenedstring = shortenedstring.slice(0,shortenedstring.length - 1);
        shortenedelement.text(shortenedstring);
      }
      shortenedstring = $.trim(shortenedstring.slice(pattern.length,shortenedstring.length));
      shortenedelement.text(shortenedstring + pattern);
    }
  }

  //----- STYLES -----//
  // PAGE //
  var headerwidth = 50;
  $("#page").css("height", $("body").height() - headerwidth);

  // SIDEBAR //
  $(".sidebar li").hover(function() {

    if($(this).find("span.track").length != 0)
      $(this).find("span.track").css("background-position", "0 -12px");
    if($(this).find("span.playlist").length != 0)
      $(this).find("span.playlist").css("background-position", "-12px -12px");
    if($(this).find(".location").length != 0) {
      $(this).find(".location").css("color", "#3c4e5c");
      stringShortener($(this).find(".location"),142);
    }

  },
  function() {

    if($(this).find("span.track").length != 0)
      $(this).find("span.track").css("background-position", "0 0");
    if($(this).find("span.playlist").length != 0)
      $(this).find("span.playlist").css("background-position", "-12px 0");
    if($(this).find(".location").length != 0)
      $(this).find(".location").css("color", "#727272");

  });

  // SPOTIFY //
  var sp = getSpotifyApi(1);

  // MAPS //
  var myLatlng = new google.maps.LatLng(-34.397, 150.644);

  var mapOptions = {
    center            : myLatlng,
    zoom              : 8,
    MapTypeId         : google.maps.MapTypeId.ROADMAP,
    panControl        : false,
    mapTypeControl    : false,
    streetViewControl : false
  };

  var map = new google.maps.Map(document.getElementById("map"),mapOptions);

  var marker = new google.maps.Marker({
    background  : myLatlng,
    map         : map
  });

  var createLocationWindow = new CreateLocationWindow({latlng: marker.getPosition(), map: map});
  var createDescriptionWindow = new CreateDescriptionWindow({latlng: marker.getPosition(), map: map});*/


  //----- INITIALIZE -----//
$(window).load(function() {
  /*$(".sidebar li .location").each(function(index) {
      stringShortener($(this),142);
  });*/
});

      
    </script>

        <!-- Spotify CSS Files -->
        <link rel="stylesheet" type="text/css" charset="utf-8" href="sp://resources/css/eve.css">
        <link rel="stylesheet" type="text/css" charset="utf-8" href="sp://resources/css/api.css">
        <link rel="stylesheet" type="text/css" charset="utf-8" href="sp://resources/css/player.css">

        <link rel="stylesheet" type="text/css" charset="utf-8" href="sp://mojo-pin/css/github.css">
        <link rel="stylesheet" type="text/css" charset="utf-8" href="sp://mojo-pin/css/main.css">

    </head>
    <body>
        <!---------- HEADER ---------->
        <div id="header">
            <h1>Mojo Pin</h1>
            <nav>
              <ul class="navigation left">
                 <li>News</li>
                 <li>Profile</li>
              </ul>
              <ul class="navigation right">
                
                <li>Friends</li>
                <li class="active mp-icon"><span class="mp-plus"></span>Pin</li>
              </ul>
            </nav>
        </div>

      <!---------- PAGE ---------->
      <div id="page">

        <!-- CATEGORY: 2.MUSIC -->
        <div class="category music" style="display: none;">
                <h2>Pin a new track or playlist to your memory map</h2>
                <form>
                    <input type="text" />
                    <div class="output" style="display: none;">
                        <div class="title" id="tracks">Tracks</div>
                        <ul>
                            <li><img src="../img/default_cover-22x22.gif"><span>So Real</span> by Jeff Buckley</li>
                            <li><img src="../img/default_cover-22x22.gif"><span>Mojo Pin</span> by Jeff Buckley</li>
                            <li><img src="../img/default_cover-22x22.gif"><span>Grace</span> by Jeff Buckley</li>
                            <li><img src="../img/default_cover-22x22.gif"><span>Last Goodbye</span> by Jeff Buckley</li>
                            <li><img src="../img/default_cover-22x22.gif"><span>Lilac Wine</span> by Jeff Buckley</li>
                        </ul>
                        <div class="title" id="playlists">Playlists</div>
                        <ul>
                            <li><img src="../img/default_cover-22x22.gif"><span>Sad Songs, Acoustic and Jeff Buckley</span> by Jack...</li>
                            <li><img src="../img/default_cover-22x22.gif"><span>Jefferson Airplane - Best Of</span> by cisackson</li>
                            <li><img src="../img/default_cover-22x22.gif"><span>Jeff Wayne – Jeff Wayne's Musical Version of ...</span></li>
                        </ul>
                    </div>
                    <div class="playing">Use currently playing:<span><span class="volume on"></span>After the Rain by Little Dragon</span></div>
                </form>
                
                <div id="dropzone">
                    <div class="cover">
                    </div>
                    <div class="meta">
                        <div class="track-name">After The Rain</div>
                        <div class="artist-name">Little Dragon</div>
                    </div>
                </div>
                <div id="dropzone" class="blank">
                    <p><span class="arrowdown"></span>Drag & Drop any playlist</p>
                </div>

          <!---------- PAGINATION ---------->
          <div class="pagination">
              <div class="left">
                  <button class="sp-button mp-dark">Cancel</button>
              </div>
              <div class="right">
                  <button class="sp-button sp-icon mp-icon"><span class="mp-arrowright"></span>Next</button>
              </div>
          </div> 
            
        </div>
        
        
        <!-- CATEGORY: 2.LOCATION -->
        <div class="category location">
            <!---------- MAP ---------->
            <div id="map"></div>
            <!---------- PAGE BOTTOM ---------->
            <div class="page-bottom">
                <form>
                    <span class="mp-location"></span>
                    <input type="text" />
                </form>
            </div>
            <!---------- PAGINATION ---------->
            <div class="pagination">
                <div class="left">
                    <button class="sp-button sp-icon mp-icon"><span class="mp-arrowleft"></span>Previous</button>
                </div>
                <div class="right">
                    <button class="sp-button sp-icon mp-icon"><span class="mp-arrowright"></span>Next</button>
                    or <span>Cancel</span>
                </div>
            </div>
        </div>

<!-- Description -->

        <div class="section description" style="display: none;">
          <div class="content">
          </div>
          <footer>
            <div class="left">
              <button class="sp-button sp-icon mp-icon"><span class="mp-arrowleft"></span>Previous</button>
            </div>
            <div class="middle">
              <form>
                <textarea>Message (Optional)</textarea>
              </form>
              <div class="social">
                Share to
                <div class="buttons">
                  <button class="sp-button sp-icon mp-social"><span class="mp-facebook"></span>Facebook</button>
                  <button class="sp-button sp-icon mp-social"><span class="mp-twitter"></span>Twitter</button>
                </div>
              </div>
            </div>
            <div class="right">
              <button class="sp-button sp-primary">Publish</button>
              or <span>Cancel</span>
            </div>
          </footer>
        </div>

<!-- Profile -->

        <div class="section profile" style="display: none;">
          <div class="header">
            <div class="picture">
            </div>
            <div class="information">
              Chloé Laisné
              <div><span class="disc"></span>9 memories</div>
              <div>7 tracks, 2 playlists</div>
            </div>
          </div>
          <div class="content">
            <div id="map_canvas" style="width:100%; height:100%"></div>
            <div class="sidebar">
              <ul>
                <li>
                  <div class="music"><span class="track"></span><b>After The Rain</b> by Little Dragon</div>
                  <div class="location">Amsterdam</div>
                </li>
                <li>
                  <div class="music"><span class="playlist"></span><b>Little Dragon Mixtape</b> by chloe.laisne</div>
                  <div class="location">Hyper Island, Stockholm</div>
                </li>
                <li>
                  <div class="music"><span class="track"></span><b>We be</b> by Wax Tailor</div>
                  <div class="location">Strassmannstras, Berlin, Germany</div>
                </li>
                <li>
                  <div class="music"><span class="track"></span><b>Obsession Never Sleeps</b> by Scott Matthews</div>
                  <div class="location">Huddinge, Stockholm</div>
                </li>
                <li>
                  <div class="music"><span class="track"></span><b>Lilac Wine</b> by Jeff Buckley</div>
                  <div class="location">Gamla Stan, Stockholm</div>
                </li>
                <li>
                  <div class="music"><span class="playlist"></span><b>Drive - original soundtracks</b> by joostgroenendijk</div>
                  <div class="location">Odenplan, Stockholm</div>
                </li>
              </ul>
            </div>
          </div>
          <footer>
          </footer>
        </div>
      </div>

    </body>

</html>
